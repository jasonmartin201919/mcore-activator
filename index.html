<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MCORE 授权管理中心</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --main-bg: #0f172a; --accent: #4f46e5; --card-bg: rgba(30, 41, 59, 0.7); }
        .admin-mode { --main-bg: #1a150e; --accent: #d4af37; --card-bg: rgba(45, 38, 25, 0.8); }
        body { background: var(--main-bg); transition: background 0.5s ease; }
        .glass { background: var(--card-bg); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .gold-glow { box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); border: 1px solid #d4af37 !important; }
        .btn-glow { background: var(--accent); box-shadow: 0 4px 14px 0 rgba(0,0,0,0.3); transition: all 0.3s; }
        .btn-glow:active { transform: scale(0.95); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 antialiased">

<div id="mainContainer" class="glass p-6 md:p-10 rounded-[2rem] w-full max-w-md shadow-2xl transition-all duration-500">
    <div class="text-center mb-8">
        <div id="modeBadge" class="hidden inline-block px-3 py-1 rounded-full border border-[#d4af37] text-[#d4af37] text-[10px] uppercase tracking-[0.2em] mb-4">Super Admin Mode</div>
        <h1 class="text-3xl font-black italic tracking-tighter text-white">MCORE <span id="versionText" class="text-indigo-400">2.5</span></h1>
        <p id="subTitle" class="text-gray-400 text-xs mt-2 font-light">官方自助授权与安全核验系统</p>
    </div>

    <div class="space-y-5">
        <div class="relative">
            <input type="text" id="orderId" oninput="checkSuperCode(this.value)" placeholder="输入订单号或特权码" 
                class="w-full bg-black/20 border border-white/10 rounded-2xl px-5 py-4 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-white placeholder:text-gray-600 text-center font-mono transition-all">
        </div>
        
        <button onclick="processRequest()" id="actionBtn" class="btn-glow w-full py-4 rounded-2xl font-bold text-white text-sm tracking-widest uppercase">
            立即核验身份
        </button>

        <div id="resultArea" class="hidden animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div class="p-6 bg-white/5 rounded-3xl border border-white/5 text-center space-y-3">
                <p id="resLabel" class="text-[10px] text-gray-500 uppercase tracking-widest">您的专属激活码</p>
                <div id="keyCode" class="text-xl font-mono font-bold text-white break-all tracking-wider select-all"></div>
                
                <div class="flex justify-center gap-2 pt-2">
                    <span id="statusTag" class="text-[9px] px-2 py-1 rounded border"></span>
                    <span id="resetCountTag" class="text-[9px] px-2 py-1 rounded border bg-white/5 border-white/10"></span>
                </div>

                <div id="emailNotice" class="text-[10px] text-gray-500 mt-4 leading-relaxed pt-4 border-t border-white/5">
                    需要解绑？请发送邮件至：<br>
                    <span class="text-indigo-400 font-medium">support@mcore-tech.com</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const SUPER_SECRET = "940715";

    // 实时检测超级码
    function checkSuperCode(val) {
        const body = document.body;
        const container = document.getElementById('mainContainer');
        const badge = document.getElementById('modeBadge');
        if (val === SUPER_SECRET) {
            body.classList.add('admin-mode');
            container.classList.add('gold-glow');
            badge.classList.remove('hidden');
            document.getElementById('versionText').innerText = "PRO";
            document.getElementById('versionText').style.color = "#d4af37";
        } else {
            body.classList.remove('admin-mode');
            container.classList.remove('gold-glow');
            badge.classList.add('hidden');
            document.getElementById('versionText').innerText = "2.5";
            document.getElementById('versionText').style.color = "#818cf8";
        }
    }

    async function processRequest() {
        const input = document.getElementById('orderId').value.trim();
        const btn = document.getElementById('actionBtn');
        const resArea = document.getElementById('resultArea');

        btn.disabled = true;
        btn.innerText = "正在同步云端数据...";

        if (input === SUPER_SECRET) {
            // 超级码模式：模拟从超级池提取
            setTimeout(() => {
                document.getElementById('keyCode').innerText = "MCORE-GOLD-VIP-" + Math.random().toString(36).substr(2, 9).toUpperCase();
                document.getElementById('statusTag').innerText = "特权授权";
                document.getElementById('statusTag').className = "text-[9px] px-2 py-1 rounded border border-[#d4af37] text-[#d4af37]";
                document.getElementById('resetCountTag').innerText = "无限次解绑";
                resArea.classList.remove('hidden');
                btn.innerText = "超级权限已确认";
                btn.disabled = false;
            }, 800);
            return;
        }

        // 普通订单逻辑
        try {
            const res = await fetch(`pool.json?t=${Date.now()}`);
            const data = await res.json();
            const pool = data.pool || [];

            // Hash 映射逻辑保持不变...
            let hash = 0; for (let i = 0; i < input.length; i++) { hash = ((hash << 5) - hash) + input.charCodeAt(i); }
            const keyData = pool[Math.abs(hash) % pool.length];

            document.getElementById('keyCode').innerText = keyData.code;
            document.getElementById('statusTag').innerText = keyData.mid ? "已绑定设备" : "待激活";
            document.getElementById('resetCountTag').innerText = `剩余解绑: ${3 - (keyData.reset_history?.length || 0)}次`;
            resArea.classList.remove('hidden');
            btn.innerText = "核验完成";
        } catch (e) {
            alert("请检查订单号或稍后再试");
        } finally {
            btn.disabled = false;
        }
    }
</script>
</body>
</html>
